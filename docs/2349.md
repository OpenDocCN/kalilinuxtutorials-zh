# 一个基于语法的 HTTP 模糊器

> 原文：<https://kalilinuxtutorials.com/t-reqs-http-fuzzer/>

[![](img//a12126b73b8cb09111884490d00ebb06.png)](https://blogger.googleusercontent.com/img/a/AVvXsEiVLpSM2qeqgA-yx0yJIhYZ7IkkXfQRX8aeHu3kfPOlD-5mVL5T8xV3voiKVFz4uLkXcXR26GsAfDG9l4nvhn4JCBc1i3NdvSQWGlKWc8pvx-Aqu2X6HEtGw4m3PbdvIHaPc75x8r-g6z73g63R8NxqDgQywRGVWsCpQkfewHU0ZUT8tx3lgOZGeZu6=s728)

T-Reqs-HTTP-Fuzzer(**T**wo**Req**uest**s**)是一个基于语法的 HTTP Fuzzer，它是在 ACM CCS 2021 上发表的题为“T-Reqs: HTTP 请求走私与差异模糊化”的论文的一部分。

T-Reqs 用于通过发送 1.1 版和更早版本的变异 HTTP 请求来模糊 HTTP 服务器。它有三个主要部分:1)生成输入，2)改变生成的输入，3)将它们传送到目标服务器。

**生成输入**

送入模糊器的 CFG 语法用于生成 HTTP 请求。因为下面显示的示例语法是为请求行模糊化定制的，所以每个请求行组件和每个组件的可能值都被显式指定。这允许我们用各种形式的请求行生成有效的请求，并且从突变的角度将每个请求行组件作为一个单独的单元来处理。

**":
["]，
":
["]，
":
["]，
:
[' GET '，' POST '，' PUT '，' DELETE '，' CONNECT '，' OPTIONS '，' TRACE '，' PATCH']，
":
[' ']，
":
['/*']，
":
['HTTP']，
。***

 ***突变输入**

每个组件可以用两种方式标记:字符串可变和树可变(参见示例配置)。如果一个组件是字符串可变的，那么一个随机字符可以被删除、替换或插入到一个随机位置。在下面(左侧)的例子中，删除了协议版本中的最后一个字符( *1* )，方法名中的第三个字母( *S* )替换为 *R* ，并在 URI 的开头插入了一个正斜杠。然而，如果一个组件是树可变的，那么一个随机组件可以被删除、替换或插入到该组件下的任意位置。下面的例子(右侧)显示了应用于请求行组件的三个树突变:1) *方法*被*协议*替换，2)额外的 *URI* 被插入到当前 URI 之后，以及 3)现有的*协议*被删除。

**用途**

**配置**

模糊器应该被告知关于输入的产生和突变的用户偏好。更具体地说，应该在配置文件中指定输入语法、可变组件、变异偏好等(参见示例配置)。

**运行模式**

为了能够再现在每次迭代中生成和变异的输入，使用了一个种子号。事实上，这个种子号在输入的形成和突变过程中充当随机数生成的种子。根据这些种子如何被送入起毛机，它以两种模式之一运行:个体和集体。在个体模式中，基于用户指定的种子来生成和变异输入。在下面的命令中，指定了一个种子(即 505)。或者，可以用 *-f* 选项指定种子列表(更多信息请参见帮助页面)。

**python 3 main . py-I-c config-s 505**

然而，在集合模式(这是默认的)中，它从零开始作为种子值，并在每次迭代中递增，直到达到结束数。可以自定义起始和结束编号。

**python3 main.py -c 配置**

**用于查找小时差异**

HTTP 请求走私依赖于服务器之间不同的主体解析行为，其中一个服务器使用 Transfer-Encoding 头，而另一个服务器更喜欢使用 Content-Length 头来决定请求主体的边界，或者一个服务器忽略请求主体，而另一个服务器处理它。

为了分析服务器对各种 HTTP 请求形式的各种变化的主体解析，我们需要在这些服务器上安装一个反馈机制来告诉我们主体解析的行为。在服务器上安装反馈机制的一种方法是以反向代理模式运行服务器，并让它将请求转发给作为服务运行的“反馈提供者”脚本。该服务测量接收到的请求的正文长度，并保存它，以便以后与其他服务器进行比较。

该库中提供了一个“反馈提供者”脚本示例。但是，这个脚本在响应中发送回身体长度信息，并假设该信息存储在客户端。

[**Download**](https://github.com/bahruzjabiyev/T-Reqs-HTTP-Fuzzer)*