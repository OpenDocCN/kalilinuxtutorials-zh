# Hassh:用于识别特定客户机和服务器 ssh 实现的工具

> 原文：<https://kalilinuxtutorials.com/hassh-client-server-ssh/>

HASSH 是一种网络指纹标准，可用于识别特定的客户端和服务器 SSH 实现。指纹可以以小型 MD5 指纹的形式轻松存储、搜索和共享。

**亦读 [网络地图:Nmap 网络仪表盘和报道](https://kalilinuxtutorials.com/webmap-nmap/)**

## 有什么可以帮忙的吗？

*   在高度受控、易于理解的环境中使用，在这种环境中，任何已知良好指纹集合之外的指纹都是可以察觉的。
*   可以在比 IP 源更高的粒度级别上检测、控制和调查暴力破解或 Cred 填充密码尝试，这可能会受到 NAT 或类似僵尸网络行为的影响。hassh 将是正在使用的特定客户端软件实现的一个特性，即使 IP 被命名为由许多其他 ssh 客户端共享。
*   检测客户端算法集的组件内的数据的秘密泄露。在这种情况下，经过特殊编码的 SSH 客户端可以在一系列 SSH_MSG_KEXINIT 数据包内将数据从受信任的环境发送到不太受信任的环境。在类似于更广为人知的通过 DNS 进行过滤的情况下，数据可能会以一系列尝试过的、但不完整且未标记的连接方式发送到由不良行为者控制的 SSH 服务器，然后这些不良行为者可以记录、解码这些数据并将其重新构建为原始形式。直到现在，这种尝试——更不用说明文包的内容——甚至没有被成熟的包分析器或端点系统记录下来。现在，通过在具有多个不同 hassh 的 SSH 客户端上使用异常检测或警报，可以很容易地执行这种类型的过滤检测
*   与其他上下文指示器结合使用，例如检测网络发现和异常 hassh 的横向移动尝试，如 Paramiko、Powershell、Ruby、Meterpreter、Empire 所使用的。
*   分享恶意哈希作为妥协的指标。
*   创建额外级别的客户端应用程序控制，例如，可以阻止所有客户端连接到一个 SSH 服务器，该服务器不在一组已批准的已知 hassh 值范围内。
*   有助于取证环境中的不可否认性——在比 IPSource 更高的抽象级别——这可能会受到 NAT 的影响，或者使用多个 IP 源。
*   检测欺骗性应用程序。例如，已知属于 Cowry/Kippo SSH 蜜罐服务器安装的 hasshServer 值，该值声称是服务器字符串中的公共 OpenSSH 服务器。
*   检测具有已知属于 IOT 嵌入式系统的 hassh 的设备。示例可能包括摄像机、麦克风、键盘记录器、窃听装置，它们可以很容易地隐藏起来，并通过加密通道悄悄地与控制服务器进行通信。

## 它是如何工作的？

“hassh”和“hasshServer”是 MD5 哈希，由各种 ssh 客户端和服务器应用程序支持的一组特定算法构造而成。这些算法在最初的 TCP 三次握手之后作为称为“SSH_MSG_KEXINIT”消息的明文包进行交换，并且是最终加密 SSH 通道设置的组成部分。这些算法的存在和排序是足够独特的，使得它可以被用作指纹来帮助识别底层客户端和服务器应用或独特的实现，而不管更高级别的表面标识符，例如“客户端”或“服务器”字符串。

[![](img//d861a9096555aeb1980fc054015933d7.png) ](https://github.com/salesforce/hassh/) **学分**

hassh 和 hasshServer 是由 Salesforce 的探测云团队中的 **Ben Reardon** 构思和开发的，灵感和贡献来自**阿黛尔卡利米**和 **JA3 工作人员**工作人员:**约翰 b 奥尔豪斯**、**杰夫阿特金森**和**乔希阿特金斯。**

***你可以在 [Linkedin](https://www.linkedin.com/company/gbhackers/) 、 [Twitter](https://twitter.com/GbhackerOn) 、[脸书](https://www.facebook.com/gbhackersadmin)上关注我们的日常网络安全更新，你也可以在线参加[最佳网络安全课程](https://ethicalhackersacademy.com/)以保持自我更新。***