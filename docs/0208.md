# upload scanner:Burp 代理的 HTTP 文件上传扫描器

> 原文：<https://kalilinuxtutorials.com/uploadscanner-http-file-upload-scanner/>

UploadScanner 是一个 Burp Suite Pro 扩展，用于对 HTTP 文件上传进行安全测试。测试 web 应用程序是每个安全分析师的标准任务。存在各种自动化和半自动的安全测试工具来简化任务。基于 HTTP 的文件上传是一个特殊的用例。

然而，大多数自动化 web 应用程序安全扫描器在遇到文件上传时不会调整它们的攻击，因此很可能会遗漏与文件上传功能相关的漏洞。

虽然 web 上记录了许多用于文件上传测试的技术，但是自动化此类攻击所需的代码却经常缺失。在其他情况下，这些技术只适用于非常特殊的用例。这项研究的目标之一是概括和自动化这些攻击。

攻击技术包括一般攻击，如跨站点脚本(XSS)、外部实体注入(XXE)和 PHP/JSP/ASP 代码注入，但目标是执行这些针对基于 HTTP 的文件上传用例定制的攻击。此外，对服务器端解析器的更具体的攻击被用作攻击媒介，例如服务器端请求伪造(SSRF)到使用 LibAv 解析的 m3u8 播放列表文件格式。

网站上的文件上传对于安全测试来说是一个被低估的领域。解析文件的服务器上的攻击面自然会大得多。虽然一些可能发生的问题得到了高度关注(例如 ImageTragick 漏洞)，但每天都有无数的内存损坏错误在各种解析中得到修复，这些错误也可能在您的 web 服务器上使用。

**也读[Darling–Darwin/Mac OS 仿真层 For Linux](https://kalilinuxtutorials.com/darling-mac-os-linux/)**

虽然您的 REST XML web 服务可能不容易受到 XML 外部实体(XXE)注入的影响，但这并不意味着您的 JPEG XMP 元数据(XML)图像解析器没有 XXE 问题。成功上传文件需要各种技术，包括文件扩展名、内容类型和内容的关联。

此外，文件内容必须通过服务器端的检查或修改，如图像大小要求或调整大小操作。这个扩展的另一个目标是绕过服务器端的处理，创建在修改后仍然存在的内容，或者创建在修改后产生所需有效载荷的内容。

虽然已经有几个 Burp 扩展在做一些检查，但是这个扩展试图实现大多数对文件上传可行的攻击。该扩展正在测试各种攻击，并被划分为多个模块。每个模块处理几个相同类别的攻击。

## **上传扫描功能**

虽然该扩展在其各种模块中有各种有趣的特性，但其中一个主要特性是:

1.  取一个小的 gif，png，jpeg，tiff，pdf，zip 和 mp4 文件
2.  如果是图像，调整图像大小(大小是 UI 选项)
3.  如果是图像，给它一个随机的新颜色
4.  如果文件格式支持，使用 exiftool 文件格式元数据技术“关键字”、“注释”、“iptc:关键字”、“xmp:关键字”、“exif:ImageDescription”和“thumbnail image”…
5.  注入 PHP，JSP，ASP，XXE，SSRF，XXS 和 SSI 的有效载荷…
6.  上传文件扩展名和内容类型的各种组合…
7.  通过基于睡眠的有效负载、打嗝合作者交互或通过再次下载文件来检测问题

安装扩展后，检查扩展的**全局&主动扫描配置**选项卡。如果字段被标记为红色，则表示有错误。

[![](img//d861a9096555aeb1980fc054015933d7.png) ](https://github.com/PortSwigger/upload-scanner) **鸣谢:托比亚斯“弗洛伊德”奥斯佩尔特，@弗洛伊德 _ch**