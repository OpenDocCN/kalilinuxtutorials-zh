# Allstar : GitHub 应用程序，用于设置和执行安全策略

> 原文：<https://kalilinuxtutorials.com/allstar/>

[![PayloadsAllTheThings : A List Of Useful Payloads & Bypass](img//8b710e427825335c52359c7ad64c8ca1.png "PayloadsAllTheThings : A List Of Useful Payloads & Bypass")](https://1.bp.blogspot.com/-5jufYWTStXU/YSTNKYcZlNI/AAAAAAAAKjI/eQUHKtOSLqEvBXvMz6q0ClnAZcJlFxMigCLcBGAsYHQ/s651/allstar-github-app%2B%25281%2529.png)

Allstar 是一款 GitHub 应用，安装在组织或存储库上，用于设置和执行安全策略。它的目标是能够持续监控和检测任何 GitHub 设置或存储库文件内容，这些设置或内容可能有风险或不符合安全最佳实践。如果 Allstar 发现某个存储库不合规，它将采取措施，例如创建问题或恢复安全设置。

具体的政策是高度可配置的，试图满足不同项目社区和组织的需求。此外，制定和贡献新的政策是容易的。

Allstar 是 OpenSSF 组织开发的，是安全关键项目工作组的一部分。OpenSSF 在这里运行一个 Allstar 实例，任何人都可以在他们的 GitHub 组织上安装和使用。然而，如果需要的话，任何人都可以运行 Allstar，详情请参见运营商文档。

**快速启动**

在您的组织和存储库中安装 Allstar GitHub 应用程序。安装 Allstar 时，您可以查看请求的权限。Allstar 要求对大多数设置和文件内容的读取权限，以检测安全合规性。它请求对问题的写访问以创建问题，并请求对检查的写访问以允许`**block**`动作。

按照快速入门说明设置在您的存储库上启用 Allstar 所需的配置文件。有关高级配置的更多详细信息，请参见下文。

救命！我收到了全明星制造的问题，我不想要它们。

**启用配置**

Allstar 可以在应用程序级别的各个存储库上启用，可以选择单独启用或禁用每个安全策略。对于组织级配置，在您的组织中创建一个名为`**.allstar**`的存储库。然后在存储库中创建一个名为`**allstar.yaml**`的文件。

Allstar 可以设置为选择加入或选择退出策略。在选择加入中，只有那些明确列出的存储库才被启用。在选择退出中，所有存储库都被启用，并且需要将存储库显式添加到选择退出中。默认情况下，Allstar 设置为选择加入，因此安装后不会立即在任何存储库上启用。要继续使用默认的选择加入策略，请列出您组织中要启用的 Allstar 的存储库，如下所示:

**optConfig:
optin repos:
回购一
回购二**

要切换到退出策略(推荐)，请将该选项设置为 true:

**opt config:
opt out strategy:true**

如果您希望在除少数资料库之外的所有资料库上启用 Allstar，您可以选择退出并列出要禁用的资料库:

**opt config:
optout strategy:true
optOutRepos:
repo-one
repo-two**

**储存库覆盖**

单个存储库也可以使用这些存储库中的配置文件来选择加入或退出。例如，如果组织配置了退出策略，存储库可以通过包含文件`**.allstar/allstar.yaml**`来退出，该文件包含以下内容:

**opt config:
opt out:true**

相反，当组织配置了选择加入策略时，这允许存储库选择加入并启用 Allstar。因为选择加入是默认策略，如果 **`.allstar`** 存储库不存在，这就是 Allstar 的工作方式。

在组织级别`**allstar.yaml**`，可通过以下设置禁用存储库覆盖:

**optConfig:
disableRepoOverride:true**

这使得组织所有者可以通过 GitHub PR 为请求退出的存储库设置一个中心审批点。可以理解的是，Allstar 或单个策略可能并不适用于所有存储库。

**策略启用**

每个单独的策略配置文件(见下文)也包含完全相同的`**optConfig**`配置对象。这允许在单个存储库上启用策略的粒度。只有在启用了**和** Allstar 的情况下，策略才会生效。

**动作**

每个策略都可以配置一个 Allstar 在检测到存储库不符合时将采取的操作。

*   `**log**`:这是默认动作，实际上所有动作都会发生。记录所有策略运行结果和详细信息。日志目前只对应用程序运营商可见，公开这些日志的计划正在讨论中。
*   `**issue**`:这个动作产生了一个 GitHub 问题。每个策略只创建一个问题，文本描述了违反策略的详细信息。如果问题已经公开，则每 24 小时对其进行一次评论(目前用户不可配置)。一旦违规问题得到解决，Allstar 将在 5-10 分钟内自动关闭该问题。
*   `**fix**`:此操作是特定于策略的。该策略将对 GitHub 设置进行更改，以纠正策略违规。并非所有政策都能支持这一点(见下文)。

已提出但尚未实施的行动。将来会添加定义。

*   Allstar 可以设置一个 GitHub 状态检查，如果检查失败，就会阻止库中的任何 PR 被合并。
*   Allstar 会向存储库管理员发送一封电子邮件。
*   Allstar 会向某个特定组织的系统发送一个 rpc。

**政策**

与 Allstar app enable 配置类似，所有策略都是通过组织的`**.allstar**`存储库或存储库的`**.allstar**`目录中的 yaml 文件来启用和配置的。与应用程序一样，默认情况下策略是选择加入的，默认的`**log**`操作也不会产生可见的结果。启用所有策略的一个简单方法是为每个策略创建一个 yaml 文件，其内容如下:

**opt config:
opt out strategy:true
动作:发布**

`**fix**`动作尚未在任何策略中实现，但将在那些很快适用的策略中实现。

**分支保护**

这个策略的配置文件被命名为`**branch_protection.yaml**`，配置定义在这里。

分支保护策略检查 GitHub 的分支保护设置是否按照指定的配置正确设置。问题文本将描述哪个设置不正确。请参阅 GitHub 的文档以更正设置。

**双星神器**

这个策略的配置文件被命名为 **`binary_artifacts.yaml`** ，配置定义在这里。

该政策纳入了记分卡检查。从存储库中删除二进制工件以实现合规性。由于记分卡的结果可能很详细，您可能需要运行记分卡本身来查看所有详细信息。

**外部合作者**

这个策略的配置文件被命名为`outside.yaml`，配置定义在这里。

该策略检查是否有任何外部协作者拥有对存储库的管理员(默认)或推送(可选)访问权限。只有组织成员应该拥有这种访问权限，否则不受信任的成员可以更改管理员级别的设置并提交恶意代码。

**SECURITY.md**

这个策略的配置文件被命名为 **`security.yaml`** ，配置定义在这里。

该策略检查存储库在`**SECURITY.md**`中是否有安全策略文件，以及它是否为空。创建的问题将有一个到 GitHub 选项卡的链接，帮助您将安全策略提交到存储库。

**未来政策**

*   确保 dependabot 已启用。
*   检查依赖关系是否被固定/冻结。
*   来自记分卡的更多检查。

**示例配置库**

将此回购视为正在使用的 Allstar 配置的示例。作为组织管理员，考虑一个 README.md，其中包含一些关于 Allstar 在您的组织中的使用情况的信息。

[**Download**](https://github.com/ossf/allstar)