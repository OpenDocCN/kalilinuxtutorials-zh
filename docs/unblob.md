# 从任何类型的容器格式中提取文件

> 原文：<https://kalilinuxtutorials.com/unblob/>

[![](img/5d54fdbc72da0f92acd4093024fa1b59.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTzrRiWj3CqXMVHY_S70PlZHZRooLoigixNeXniumFgydBbiTca0fdlmEDNk7WTamaCZEejT_CN-6hjhZti79Kmvys6YAoHDF-n3pN1Z3QZXIQ0bg3uzBVzGhrWVxKdDXTMTZGdH0xvE530JYITfXG_hr4WCMHYHR5i2S42N7wDH4bl7eNL7vBOJ80/s728/87724652%20(5).png)

**unbob**是一个*准确、快速、易用的* **提取套件**。它解析 30 多种不同的*存档、压缩和文件系统格式*，**递归地提取**它们的**内容**，**从**中切割出**未被考虑的**未知块。

unbob*可以自由使用*，获得*麻省理工学院许可*。它有一个命令行界面，可以用作 Python 库。
这使得 unblob 成为提取、**分析**和**逆向工程固件映像**的完美伴侣。

## 为什么不播？

嵌入式安全分析的主要挑战之一是对任意固件的可靠和安全提取。

可以从这些固件映像中提取信息的专门工具已经存在，但我们正在开发更智能的工具，可以识别特定块(例如文件系统、压缩流、归档等)的**开始偏移**和**结束偏移**。

我们**在导出这些偏移量时尽可能地坚持格式标准**，并且我们清楚地定义了我们想要从已识别的块中得到什么(例如，不将元数据提取到磁盘，删除填充)。这种策略帮助我们将已知的有效数据输入提取器，**精确识别**数据块，将未知的未知转化为已知的未知。

考虑到 un bob 的**模块化设计**和不断扩展的支持格式库，un bob 可以很好地用于嵌入式安全以外的领域，如数据恢复、内存取证或恶意软件分析。

## 我们的目标

unblob 的开发考虑了以下目标:

*   **准确性**–使用经过实战检验的规则来确定数据块的起始偏移量，同时根据格式标准来计算结束偏移量，而不偏离格式标准。我们通过验证头结构和丢弃重叠的块来尽可能地减少误报。
*   **安全性**–取消通告不需要提升特权即可运行。它经过了严格的测试，并针对大量文件和固件映像进行了模糊测试。我们依靠最新的第三方依赖关系来限制潜在的供应链问题。我们使用我们审计过的安全提取器，并在需要的地方进行了修复(参见 ubi_reader 中的路径遍历，jefferson 中的路径遍历，Yara 中的整数溢出)。
*   **可扩展性**–unbob 公开了一个 API，可以用来立即编写定制的格式处理程序和提取器。
*   **速度**–我们希望 unblob 快如闪电，这就是为什么我们默认使用多处理，确保编写高效的代码，使用内存映射文件，并使用 Hyperscan 作为高性能匹配库。计算密集型函数用 Rust 编写，并使用特定的绑定从 Python 中调用。

## 它是如何工作的？

取消块识别文件中已知和未知的数据块:

*   **已知块**通过使用搜索规则找到开始偏移来识别，并且基于格式标准来计算结束偏移。**未知数据块**表示在已知数据块之前、之后或之间的未识别数据块。由已知内容组成的未知块(例如，空填充、`**0xFF**`填充)被自动识别并如此报告。
*   unblob 将**在磁盘上切出**已知的块，并使用分配给给定处理程序的提取器执行**提取**阶段。然后，它将遍历提取的内容，在提取的文件中寻找块。
*   unblob 可以生成关于元数据的报告，提供关于已识别块的详细信息(格式、偏移量、大小、熵)及其提取的内容(如果可用的话)(所有权、权限、时间戳等)。

## 使用的技术

*   unblob 是用 Python 写的。
*   为了快速搜索文件中的二进制模式，我们使用 Hyperscan。
*   为了提取可识别的格式，我们使用各种不同的提取器。
*   对于 ELF 分析，我们使用 LIEF 及其 Python 绑定。
*   对于 CPU 密集型任务(例如熵计算)，我们使用 Rust 来加速。
*   对于漂亮的命令行界面，我们使用点击库。
*   对于结构化日志，我们使用 structlog 库。
*   有关开发和测试工具，请参见开发页面。

[**Download**](https://github.com/onekey-sec/unblob#quickstart)